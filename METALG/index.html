<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="theme-color" content="#000000" />
  <title>VYPER // AGENT SYSTEM</title>
  <link href="https://fonts.googleapis.com/css2?family=VT323&family=Share+Tech+Mono&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<!-- ROTATE PROMPT -->
<div id="rotate-prompt">
  <div class="rotate-inner">
    <div class="rotate-icon">&#8635;</div>
    <div class="rotate-text">GIRE O DISPOSITIVO</div>
    <div class="rotate-sub">Para acessar o sistema</div>
  </div>
</div>

<!-- BOOT -->
<div id="screen-boot" class="screen active">
  <div class="scanlines"></div>
  <div class="boot-wrap">
    <img src="icones/logo.png" class="boot-logo" onerror="this.style.display='none'" />
    <div class="boot-title">VYPER PESSOAL AGENT SYSTEM</div>
    <div class="boot-lines" id="boot-lines"></div>
    <div class="boot-bar-wrap"><div class="boot-bar" id="boot-bar"></div></div>
  </div>
</div>

<!-- LOGIN -->
<div id="screen-login" class="screen hidden">
  <div class="scanlines"></div>
  <div class="login-wrap">
    <div class="login-head">
      <img src="icones/logo.png" class="login-logo" onerror="this.style.display='none'" />
      <div>
        <div class="login-title">VYPER PESSOAL</div>
        <div class="login-sub">AGENT SYSTEM // v2.4</div>
      </div>
    </div>
    <div class="login-div"></div>
    <div class="role-grid">
      <button class="role-btn" id="btn-player" onclick="App.selectRole('player')">
        <span class="role-ico">&#9672;</span>
        <span class="role-lbl">OPERADOR</span>
        <span class="role-desc">Acesso a ficha pessoal</span>
      </button>
      <button class="role-btn" id="btn-gm" onclick="App.selectRole('gm')">
        <span class="role-ico">&#9670;</span>
        <span class="role-lbl">MESTRE</span>
        <span class="role-desc">Controle central</span>
      </button>
    </div>
    <div id="login-player" class="lform hidden">
      <label class="lform-label">&#9658; CODINOME DO OPERADOR</label>
      <input class="lform-input" id="input-codename" type="text" maxlength="20" placeholder="INSIRA SEU CODINOME" autocomplete="off" spellcheck="false" />
      <button class="lform-btn" onclick="App.loginPlayer()">[ ACESSAR FICHA ]</button>
      <div class="lform-err hidden" id="login-error-player"></div>
    </div>
    <div id="login-gm" class="lform hidden">
      <label class="lform-label">&#9658; CODIGO DE ACESSO</label>
      <input class="lform-input" id="input-gm-pass" type="password" maxlength="30" placeholder="&#8226;&#8226;&#8226;&#8226;&#8226;&#8226;&#8226;&#8226;" autocomplete="off" />
      <button class="lform-btn" onclick="App.loginGM()">[ ACESSO CENTRAL ]</button>
      <div class="lform-err hidden" id="login-error-gm"></div>
    </div>
    <div class="login-footer">ACESSO NAO AUTORIZADO SERA REGISTRADO E PUNIDO</div>
  </div>
</div>

<!-- SHEET -->
<div id="screen-sheet" class="screen hidden">
  <div class="scanlines"></div>

  <!-- HEADER -->
  <div class="s-header">
    <img src="icones/logo.png" class="s-header-logo" onerror="this.style.display='none'" />
    <span class="s-header-title">Vyper Pessoal Agent System</span>
    <button class="s-header-back" onclick="App.logout()">&#9167;</button>
  </div>

  <!-- BODY: 3 columns -->
  <div class="s-body">

    <!-- LEFT -->
    <div class="s-left">
      <div class="photo-frame" id="photo-frame" onclick="App.editPhoto()">
        <div class="photo-inner">
          <img id="agent-photo" src="" alt="" />
          <div class="photo-ph">
            <span>SEM FOTO</span>
            <span class="photo-hint">toque para alterar</span>
          </div>
        </div>
        <div class="photo-notch"></div>
      </div>
      <input type="file" id="photo-input" accept="image/*" class="hidden" onchange="App.handlePhotoUpload(event)" />

      <div class="reg-wrap">
        <div class="reg-title">&#9658; REGISTRO</div>

        <div class="reg-field">
          <div class="reg-key-row" onclick="App.toggleEdit('nome')">
            <span class="reg-tri">&#9660;</span><span class="reg-key">NOME</span>
          </div>
          <div class="reg-val-row">
            <span class="reg-tree">&#x2514;&#x2500;&#x2500;</span>
            <span class="reg-val" id="display-nome" onclick="App.toggleEdit('nome')">&#8212;</span>
            <input class="reg-input hidden" id="edit-nome" type="text" maxlength="20" placeholder="NOME"
              onblur="App.saveField('nome')" onkeydown="if(event.key==='Enter')App.saveField('nome')" />
          </div>
        </div>

        <div class="reg-field">
          <div class="reg-key-row" onclick="App.toggleEdit('origem')">
            <span class="reg-tri">&#9660;</span><span class="reg-key">ORIGEM</span>
          </div>
          <div class="reg-val-row">
            <span class="reg-tree">&#x2514;&#x2500;&#x2500;</span>
            <span class="reg-val" id="display-origem" onclick="App.toggleEdit('origem')">[CONFIDENCIAL]</span>
            <input class="reg-input hidden" id="edit-origem" type="text" maxlength="30" placeholder="[CONFIDENCIAL]"
              onblur="App.saveField('origem')" onkeydown="if(event.key==='Enter')App.saveField('origem')" />
          </div>
        </div>

        <div class="reg-field reg-indent">
          <div class="reg-key-row">
            <span class="reg-tri">&#9660;</span><span class="reg-key">STATUS</span>
          </div>
          <div class="reg-val-row">
            <span class="reg-tree">&#x2514;&#x2500;&#x2500;&#x2500;&#x2500;</span>
            <span class="reg-val" id="display-status-ativo">ATIVO</span>
          </div>
        </div>
      </div>
    </div><!-- /s-left -->

    <!-- CENTER -->
    <div class="s-center">

      <!-- atributos box -->
      <div class="attr-box">
        <div class="attr-box-header">&#9658; ATRIBUTOS</div>
        <div class="attr-grid">

          <div class="attr-card" onclick="App.cycleAttr('fisico')">
            <div class="attr-icon-area"><img src="icones/1.png" class="attr-img" /></div>
            <div class="attr-foot">
              <span class="attr-grade" id="grade-fisico">&#8212;</span>
            </div>
            <div class="attr-cut"></div>
          </div>

          <div class="attr-card" onclick="App.cycleAttr('intelecto')">
            <div class="attr-icon-area"><img src="icones/2.png" class="attr-img" /></div>
            <div class="attr-foot">
              <span class="attr-grade" id="grade-intelecto">&#8212;</span>
            </div>
            <div class="attr-cut"></div>
          </div>

          <div class="attr-card" onclick="App.cycleAttr('reflexos')">
            <div class="attr-icon-area"><img src="icones/3.png" class="attr-img" /></div>
            <div class="attr-foot">
              <span class="attr-grade" id="grade-reflexos">&#8212;</span>
            </div>
            <div class="attr-cut"></div>
          </div>

          <div class="attr-card attr-wide" onclick="App.cycleAttr('resiliencia')">
            <div class="attr-icon-area"><img src="icones/4.png" class="attr-img" /></div>
            <div class="attr-foot">
              <span class="attr-grade" id="grade-resiliencia">&#8212;</span>
              <img src="icones/4.png" class="attr-foot-ico" />
            </div>
            <div class="attr-cut"></div>
          </div>

          <div class="attr-card attr-wide" onclick="App.cycleAttr('presenca')">
            <div class="attr-icon-area"><img src="icones/5.png" class="attr-img" /></div>
            <div class="attr-foot">
              <span class="attr-grade" id="grade-presenca">&#8212;</span>
              <img src="icones/5.png" class="attr-foot-ico" />
            </div>
            <div class="attr-cut"></div>
          </div>

        </div>
      </div><!-- /attr-box -->

      <!-- integrity -->
      <div class="integ-wrap">
        <div class="integrity-bars" id="integrity-bars">
          <div class="integrity-bar active" data-index="0" onclick="App.toggleIntegrity(0)"></div>
          <div class="integrity-bar active" data-index="1" onclick="App.toggleIntegrity(1)"></div>
          <div class="integrity-bar active" data-index="2" onclick="App.toggleIntegrity(2)"></div>
          <div class="integrity-bar active" data-index="3" onclick="App.toggleIntegrity(3)"></div>
          <div class="integrity-bar active" data-index="4" onclick="App.toggleIntegrity(4)"></div>
        </div>
        <span class="integ-count hidden" id="integrity-count">5/5</span>
      </div>

      <!-- security -->
      <div class="sec-wrap">
        <div id="security-display" class="sec-badge seguro">
          <span id="security-text">SEGURO</span>
        </div>
      </div>

    </div><!-- /s-center -->

    <!-- RIGHT: NAV -->
    <div class="s-nav">
      <div class="nav-tab" id="nav-mald" onclick="App.switchTab('mald')">
        <div class="nav-ico-box"><img src="icones/6.png" class="nav-ico" /></div>
        <span class="nav-lbl">/MALD</span>
      </div>
      <div class="nav-tab" id="nav-radio" onclick="App.switchTab('radio')">
        <div class="nav-ico-box"><img src="icones/7.png" class="nav-ico" /></div>
        <span class="nav-lbl">/RADIO</span>
      </div>
      <div class="nav-tab" id="nav-docs" onclick="App.switchTab('docs')">
        <div class="nav-ico-box"><img src="icones/8.png" class="nav-ico" /></div>
        <span class="nav-lbl">/DOCS</span>
      </div>
      <div class="nav-tab" id="nav-fitas" onclick="App.switchTab('fitas')">
        <div class="nav-ico-box"><img src="icones/9.png" class="nav-ico" /></div>
        <span class="nav-lbl">/FITAS</span>
      </div>
      <div class="nav-tab" id="nav-equip" onclick="App.switchTab('equip')">
        <div class="nav-ico-box nav-red"><img src="icones/10.png" class="nav-ico" /></div>
        <span class="nav-lbl">/EQUIP</span>
      </div>
    </div><!-- /s-nav -->

  </div><!-- /s-body -->

  <!-- TAB OVERLAY -->
  <div id="tab-content" class="tab-overlay hidden">
    <button class="tab-back" onclick="App.switchTab('main')">&#9668; VOLTAR</button>
    <div id="tab-panel-mald"  class="tab-panel hidden">
      <div class="mald-wrap">
        <!-- View 1: Element Picker -->
        <div id="mald-view-elem" class="mald-view mald-view-elem-screen">
          <div class="mald-elem-grid">
            <div class="mald-elem-card elem-card-sangue" onclick="App.maldSelectElement('sangue')" style="background-image:url('elementos/sangue.jpg')">
              <div class="mald-elem-overlay"></div>
              <div class="mald-elem-num">01</div>
              <div class="mald-elem-corner"></div>
              <div class="mald-elem-footer">
                <div class="mald-elem-name elem-sangue">SANGUE</div>
                <div class="mald-elem-select-hint">&#9660; ACESSAR</div>
              </div>
            </div>
            <div class="mald-elem-card elem-card-morte" onclick="App.maldSelectElement('morte')" style="background-image:url('elementos/morte.jpg')">
              <div class="mald-elem-overlay"></div>
              <div class="mald-elem-num">02</div>
              <div class="mald-elem-corner"></div>
              <div class="mald-elem-footer">
                <div class="mald-elem-name elem-morte">MORTE</div>
                <div class="mald-elem-select-hint">&#9660; ACESSAR</div>
              </div>
            </div>
            <div class="mald-elem-card elem-card-energia" onclick="App.maldSelectElement('energia')" style="background-image:url('elementos/energia.jpg')">
              <div class="mald-elem-overlay"></div>
              <div class="mald-elem-num">03</div>
              <div class="mald-elem-corner"></div>
              <div class="mald-elem-footer">
                <div class="mald-elem-name elem-energia">ENERGIA</div>
                <div class="mald-elem-select-hint">&#9660; ACESSAR</div>
              </div>
            </div>
            <div class="mald-elem-card elem-card-conhecimento" onclick="App.maldSelectElement('conhecimento')" style="background-image:url('elementos/conhecimento.jpg')">
              <div class="mald-elem-overlay"></div>
              <div class="mald-elem-num">04</div>
              <div class="mald-elem-corner"></div>
              <div class="mald-elem-footer">
                <div class="mald-elem-name elem-conhecimento">CONHECIMENTO</div>
                <div class="mald-elem-select-hint">&#9660; ACESSAR</div>
              </div>
            </div>
          </div>
        </div>
        <!-- View 2: Maldições Grid -->
        <div id="mald-view-grid" class="mald-view hidden">
          <div class="mald-grid-header" id="mald-grid-header">
            <div class="mald-grid-accent" id="mald-grid-accent"></div>
            <div class="mald-grid-header-inner">
              <span class="mald-grid-title" id="mald-grid-title">MALDICOES</span>
              <span class="mald-grid-elem-lbl" id="mald-grid-elem-lbl"></span>
            </div>
            <button class="mald-back-btn" onclick="App.maldBack('elem')">&#9668; VOLTAR</button>
          </div>
          <div class="mald-slots-grid" id="mald-slots-grid"></div>
        </div>
        <!-- View 3: Curse Detail -->
        <div id="mald-view-detail" class="mald-view hidden">
          <button class="mald-back-btn" onclick="App.maldBack('grid')">&#9668; VOLTAR</button>
          <div id="mald-detail-inner" class="mald-detail-inner"></div>
        </div>
      </div>
    </div>
    <div id="tab-panel-radio" class="tab-panel hidden">
      <div class="radio-wrap">
        <div class="radio-heading">&#9658; R&#x41;&#x44;&#x49;&#x4F;</div>
        <div class="radio-stage">

          <!-- left: player -->
          <div class="radio-photo-col">
            <div class="radio-photo-frame">
              <div class="radio-photo-inner">
                <img id="radio-player-photo" src="" alt="" />
                <div class="radio-photo-ph" id="radio-player-ph">?</div>
              </div>
              <div class="radio-photo-notch"></div>
            </div>
            <div class="radio-name" id="radio-player-name">&#8212;</div>
          </div>

          <!-- center: waveform + freq + status -->
          <div class="radio-center-col">
            <div class="radio-waveform-wrap">
              <svg class="radio-wave-svg" id="radio-wave-svg" viewBox="0 0 220 50" preserveAspectRatio="none">
                <polyline class="radio-wave-line" points="0,25 10,25 18,8 26,42 34,8 42,42 50,8 58,42 66,8 74,42 82,8 90,42 98,25 106,25 114,8 122,42 130,8 138,42 146,8 154,42 162,25 170,25 178,8 186,42 194,8 202,42 210,25 220,25" />
              </svg>
            </div>
            <div class="radio-freq-row">
              <button class="radio-arr" onclick="App.radioChangeFreq(-1)">&#9664;</button>
              <span class="radio-freq-val" id="radio-freq-val">00.221</span>
              <button class="radio-arr" onclick="App.radioChangeFreq(1)">&#9654;</button>
            </div>
            <div class="radio-divider"></div>
            <div class="radio-status-badge radio-status-idle" id="radio-status-badge">OCIOSO</div>
            <div class="radio-actions" id="radio-actions">
              <button class="radio-btn" onclick="App.radioSolicitar()">SOLICITAR CONEX&#xC3;O</button>
            </div>
          </div>

          <!-- right: NPC -->
          <div class="radio-photo-col">
            <div class="radio-photo-frame">
              <div class="radio-photo-inner">
                <img id="radio-npc-photo" src="" alt="" class="hidden" />
                <div class="radio-photo-ph" id="radio-npc-ph">?</div>
              </div>
              <div class="radio-photo-notch"></div>
            </div>
            <div class="radio-name" id="radio-npc-name">&#8212;</div>
          </div>

        </div>
      </div>
    </div>
    <div id="tab-panel-docs"  class="tab-panel hidden"><div class="cs"><span class="cs-ico">&#9672;</span><span class="cs-title">DOCUMENTOS</span><span class="cs-sub">[ EM DESENVOLVIMENTO ]</span></div></div>
    <div id="tab-panel-fitas" class="tab-panel hidden">
      <div class="fitas-wrap">

        <!-- LEFT: tape list tree -->
        <div class="fitas-list-col">
          <div class="fitas-heading">&#9658; FITAS</div>
          <div id="fitas-tree" class="fitas-tree">
            <div class="fitas-empty">Nenhuma fita alocada.</div>
          </div>
        </div>

        <!-- RIGHT: cassette player -->
        <div class="fitas-player-col">
          <div class="cassette-wrap">
            <img src="icones/iconefita.png" class="cassette-img" />
          </div>

          <div class="fitas-progress-wrap">
            <div class="fitas-prog-bar" id="fitas-prog-bar" onclick="App.fitaSeek(event)">
              <div class="fitas-prog-fill" id="fitas-prog-fill"></div>
              <div class="fitas-prog-knob" id="fitas-prog-knob"></div>
            </div>
            <div class="fitas-time-row">
              <span id="fitas-time-cur">0:00</span>
              <span id="fitas-time-dur">0:00</span>
            </div>
          </div>

          <div class="fitas-controls">
            <button class="fita-btn" id="fitas-btn-loop" onclick="App.fitaToggleLoop()" title="Loop">&#10227;</button>
            <button class="fita-btn fita-btn-main" id="fitas-btn-play" onclick="App.fitaTogglePlay()">&#9654;</button>
            <button class="fita-btn" onclick="App.fitaSkip(15)" title="+15s">&#9654;&#9654; +15s</button>
          </div>

          <div class="fitas-now-playing" id="fitas-now-playing">&#9658; NENHUMA FITA SELECIONADA</div>
        </div>

      </div>
    </div>
    <div id="tab-panel-equip" class="tab-panel hidden"><div class="cs"><span class="cs-ico">&#9672;</span><span class="cs-title">EQUIPAMENTOS</span><span class="cs-sub">[ EM DESENVOLVIMENTO ]</span></div></div>
  </div>

</div><!-- /screen-sheet -->

<!-- GM -->
<div id="screen-gm" class="screen hidden">
  <div class="scanlines"></div>
  <div class="s-header">
    <img src="icones/logo.png" class="s-header-logo" onerror="this.style.display='none'" />
    <span class="s-header-title gm-title-color">CONTROLE CENTRAL // MESTRE</span>
    <button class="s-header-back" onclick="App.logout()">&#9167;</button>
  </div>
  <div class="gm-body">
    <div class="gm-sec-title">&#9658; PRESETS DE NPC (R&#xC1;DIO)</div>
    <div id="gm-npc-list" class="gm-npc-list"><div class="gm-fitas-empty">Nenhum preset.</div></div>
    <div class="gm-fitas-add" style="margin-bottom:10px">
      <input type="text" id="gm-npc-nome-input" placeholder="nome do npc..." class="gm-text-input" />
      <label class="gm-fita-upload-btn">+ FOTO
        <input type="file" accept="image/*" class="hidden" onchange="App.gmAddNpcPreset(this)" />
      </label>
    </div>
    <div class="gm-sec-title">&#9658; MALDICOES</div>
    <div id="gm-mald-list" class="gm-mald-list"><div class="gm-fitas-empty">Nenhuma maldi&ccedil;&atilde;o cadastrada.</div></div>
    <div class="gm-fitas-add" style="flex-direction:column;align-items:stretch;gap:5px;margin-bottom:10px">
      <input type="text" id="gm-mald-nome" placeholder="nome da maldição..." class="gm-text-input" style="width:100%" />
      <div style="display:flex;gap:6px;flex-wrap:wrap">
        <select id="gm-mald-elem" class="gm-select">
          <option value="sangue">SANGUE</option>
          <option value="morte">MORTE</option>
          <option value="energia">ENERGIA</option>
          <option value="conhecimento">CONHECIMENTO</option>
        </select>
        <input type="number" id="gm-mald-custo" placeholder="custo" class="gm-text-input" min="0" max="99" style="width:60px;flex:none" />
        <label style="display:flex;align-items:center;gap:4px;color:var(--green);font-family:var(--font);font-size:11px;white-space:nowrap;cursor:pointer">
          <input type="checkbox" id="gm-mald-detect" /> DETECT&Aacute;VEL
        </label>
      </div>
      <textarea id="gm-mald-desc" placeholder="descrição..." class="gm-text-input" rows="2" style="width:100%;resize:vertical"></textarea>
      <div class="gm-mald-tags-row">
        <div id="gm-mald-tags-list" class="gm-mald-tags-list"></div>
        <div style="display:flex;gap:4px;margin-top:4px">
          <input type="text" id="gm-mald-tag-input" placeholder="adicionar tag..." class="gm-text-input" style="flex:1" onkeydown="if(event.key==='Enter'){event.preventDefault();App.gmAddMaldTag()}" />
          <button class="gm-fita-upload-btn" onclick="App.gmAddMaldTag()">+ TAG</button>
        </div>
      </div>
      <div style="display:flex;gap:6px;align-items:center">
        <label class="gm-fita-upload-btn">&#43; &Iacute;CONE
          <input type="file" accept="image/*" class="hidden" onchange="App.gmPreviewMaldIcon(this)" />
        </label>
        <img id="gm-mald-icone-preview" src="" alt="" class="hidden" style="width:36px;height:36px;object-fit:cover;border:1px solid var(--border2)" />
        <button class="gm-fita-upload-btn" onclick="App.gmAddMaldicao()" style="margin-left:auto">ADICIONAR</button>
      </div>
    </div>
    <div class="gm-sec-title">&#9658; OPERADORES REGISTRADOS</div>
    <div id="gm-agent-list" class="gm-list">
      <div class="gm-empty">Nenhum operador registrado.</div>
    </div>
  </div>
</div>

<!-- TOAST -->
<div id="toast" class="toast hidden"></div>

<!-- GRADE MODAL -->
<div id="grade-modal" class="modal-bg hidden" onclick="App.closeGradeModal(event)">
  <div class="modal-panel">
    <div class="modal-title" id="grade-modal-title">SELECIONAR GRAU</div>
    <div class="modal-opts" id="grade-modal-options"></div>
  </div>
</div>

<script type="module" src="main.js"></script>
</body>
</html>
